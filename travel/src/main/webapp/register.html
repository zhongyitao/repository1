<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>注册</title>
    <link href="css/register.css" rel="stylesheet">

    <!-- Bootstrap -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/home.css" rel="stylesheet">
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="js/jquery-3.2.1.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="js/bootstrap.min.js"></script>
    <!--导入布局js，共享header和footer-->
    <!--<script src="js/include.js"></script>-->
</head>
<body>

<header id="header"></header>

<div class="rg_layout">
    <div class="rg_left">
        <p>新用户注册</p>
        <p>USER REGISTER</p>
    </div>

    <div class="rg_center">
        <div id="errorMsg" style="color:red;text-align: center"></div>
        <div class="form">
            <form method="post" id="register_form">

                <table>
                    <tr>
                        <td class="td_left"><label for="username">用户名</label></td>
                        <td class="td_right"><input type="text" name="username" id="username" placeholder="请输入用户名"></td>
                    </tr>

                    <tr>
                        <td class="td_left"><label for="password">密码</label></td>
                        <td class="td_right"><input type="password" name="password" id="password" placeholder="请输入密码">
                        </td>
                    </tr>

                    <tr>
                        <td class="td_left"><label for="name">姓名</label></td>
                        <td class="td_right"><input type="text" name="name" id="name" placeholder="请输入姓名"></td>
                    </tr>

                    <tr>
                        <td class="td_left"><label for="email">Email</label></td>
                        <td class="td_right"><input type="email" name="email" id="email" placeholder="请输入email"></td>
                    </tr>

                    <tr>
                        <td class="td_left"><label for="tel">手机号</label></td>
                        <td class="td_right"><input type="text" name="telephone" id="tel" placeholder="请输入手机号"></td>
                    </tr>

                    <tr>
                        <td class="td_left"><label>性别</label></td>
                        <td class="td_right">
                            <input type="radio" name="sex" value="male" checked>男
                            <input type="radio" name="sex" value="female">女
                        </td>
                    </tr>

                    <tr>
                        <td class="td_left"><label for="birthday">出生日期</label></td>
                        <td class="td_right"><input type="date" name="birthday" id="birthday" placeholder="请输入出生日期">
                        </td>
                    </tr>

                    <tr>
                        <td class="td_left"><label for="checkcode">验证码</label></td>
                        <td class="td_right">
                            <input type="text" name="checkcode" id="checkcode" placeholder="请输入验证码">
                            <div class="div_mig"><img id="img_check" src="/travel/authImageServlet"></div>
                        </td>
                    </tr>

                    <tr>
                        <td id="td_sub" align="center" colspan="2"><input id="btn_submit" type="button" value="注册"></td>
                    </tr>


                </table>
            </form>
        </div>
    </div>

    <div class="rg_right">
        <P>已有账号？&nbsp;<a href="login.html">立即登录</a></P>
    </div>
</div>

<footer id="footer"></footer>

<script>
    /**
     * 校验用户名
     */
    function checkUsername() {
        //获取用户名的值
        var username = $("#username").val();
        //创建正则表达式
        var reg_username = /^\w{8,20}$/;
        //判断是否符合
        var flag = reg_username.test(username);
        if (!flag) {
            $("#username").css("border", "1px solid red");
        }
        return flag;
    }

    /**
     * 校验密码
     */
    function checkPassword() {
        //获取用户名的值
        var password = $("#password").val();
        //创建正则表达式
        var reg_password = /^\w{6,20}$/;
        //判断是否符合
        var flag = reg_password.test(password);
        if (!flag) {
            $("#password").css("border", "1px solid red");
        }
        return flag;
    }

    /**
     * 校验姓名
     */
    function checkName() {
        //获取用户名的值
        var name = $("#name").val();
        //创建正则表达式
        var reg_name = /^\w{3,20}$/;
        //判断是否符合
        var flag = reg_name.test(name);
        if (!flag) {
            $("#name").css("border", "1px solid red");
        }
        return flag;
    }

    /**
     * 校验邮箱
     */
    function checkEmail() {
        //获取用户名的值
        var email = $("#email").val();
        //创建正则表达式
        var reg_email = /^\w+@\w+\.\w+$/;
        //判断是否符合
        var flag = reg_email.test(email);
        if (!flag) {
            $("#email").css("border", "1px solid red");
        }
        return flag;
    }

    /**
     * 校验手机号
     */
    function checkTelephone() {
        //获取用户名的值
        var telephone = $("#tel").val();
        //创建正则表达式
        var reg_telephone = /^((13[0-9])|(14[5,7])|(15[0-3,5-9])|(17[0,3,5-8])|(18[0-9])|166|198|199|(147))\d{8}$/;
        //判断是否符合
        var flag = reg_telephone.test(telephone);
        if (!flag) {
            $("#tel").css("border", "1px solid red");
        }
        return flag;
    }

    /**
     * 校验生日
     */
    function checkBirthday() {
        //获取用户名的值
        var birthday = $("#birthday").val();
        var flag = true;
        if (null == birthday || "" == birthday) {
            $("#tel").css("border", "1px solid red");
            flag = false;
        }
        return flag;
    }

    /**
     * 校验验证码
     */
    function checkCode() {
        //获取用户名的值
        var checkcode = $("#checkcode").val();
        var flag = true;
        if (null == checkcode || "" == checkcode) {
            $("#checkcode").css("border", "1px solid red");
            flag = false;
        }
        return flag;
    }

    //点击注册
    $("#btn_submit").click(function () {

        //校验
        var a = checkUsername();
        var b = checkPassword();
        var c = checkName();
        var d = checkEmail();
        var e = checkTelephone();
        var f = checkBirthday();
        var g = checkCode();
        if (a && b && c && d && e && f && g) {

            $.post("user/register", $("#register_form").serialize(), function (data) {
                if (data.flag) {
                    window.location = "register_ok.html";
                } else {
                    $("#errorMsg").html(data.errorMessage);
                }
            });

        }
    });

    //点击验证码图片换一张
    $("#img_check").click(function () {

        var date = new Date().getTime();
        //this.setAttribute("src","/travel/authImageServlet");
        $(this).prop("src","/travel/authImageServlet?lastTime=" + date);
    });
</script>
</body>
</html>